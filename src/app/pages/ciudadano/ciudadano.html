<div class="d-flex">

  <!-- SIDEBAR -->
  <app-barra-lateral
    [menu]="menu"
    [vistaActual]="vistaActual"
    [nombreUsuario]="nombreUsuario"
    (vistaChange)="cambiarVista($event)"
    (logout)="cerrarSesion()"
    (edit)="editarPerfil()">
    
  </app-barra-lateral>

  <!-- CONTENIDO PRINCIPAL -->
  <main class="dashboard administrador flex-fill p-4">

    <!-- PANEL -->
    <ng-container *ngIf="vistaActual === 'panel'">
      <app-titulo
        titulo="Panel de Control"
        subtitulo="Toda la informaci칩n relevante de un vistazo"
        iconoBoton="bi bi-bell"
        colorBoton="outline-custom-success"
        hoverColorBoton="custom-success-filled">
      </app-titulo>

      <div class="row g-4">
        <div class="col-md-4">
          <div class="card text-center shadow-sm">
            <div class="card-body">
              <i class="bi bi-people fs-1 text-primary"></i>
              <h5 class="mt-2">Usuarios activos</h5>
              <p class="fs-4 fw-bold">128</p>
            </div>
          </div>
        </div>

        <div class="col-md-4">
          <div class="card text-center shadow-sm">
            <div class="card-body">
              <i class="bi bi-recycle fs-1 text-primary"></i>
              <h5 class="mt-2">Kg reciclados</h5>
              <p class="fs-4 fw-bold">1.245</p>
            </div>
          </div>
        </div>

        <div class="col-md-4">
          <div class="card text-center shadow-sm">
            <div class="card-body">
              <i class="bi bi-graph-up-arrow fs-1 text-primary"></i>
              <h5 class="mt-2">Campa침as activas</h5>
              <p class="fs-4 fw-bold">6</p>
            </div>
          </div>
        </div>
      </div>
    </ng-container>

    
     <ng-container *ngIf="vistaActual === 'editar-perfil'">
      <app-titulo
        titulo="Editar Perfil"
        subtitulo="Actualiza tu informaci칩n personal"
        iconoBoton="bi bi-eye"
        colorBoton="outline-custom-success"
        >
      </app-titulo>

      <app-editar-usuario></app-editar-usuario>

     </ng-container>

    <ng-container *ngIf="vistaActual === 'solicitudes'">
      <app-titulo
        titulo="Solicitudes"
        subtitulo="Consulta tus solicitudes"
        [textoBoton]="mostrarNuevaSolicitud ? 'Mostrar solicitudes' : 'Hacer nueva solicitud'"
        iconoBoton="bi bi-plus-circle"
        colorBoton="outline-custom-success"
        hoverColorBoton="custom-success-filled"
        (clickBoton)="toggleVista()">
      </app-titulo>

      <div class="contenedor-toggle">
        <ng-container *ngIf="mostrarNuevaSolicitud">
          <div class="contenido-solicitud">
            <app-form-registro></app-form-registro>
          </div>
        </ng-container>

        <ng-container *ngIf="!mostrarNuevaSolicitud">
          <div class="contenido-solicitud">
            <app-cards-solicitud></app-cards-solicitud>
          </div>
        </ng-container>
      </div>
    </ng-container>

    <!-- RECOLECCIONES -->
    <ng-container *ngIf="vistaActual === 'recolecciones'">
      <app-titulo
        titulo="Recolecciones"
        subtitulo="Gesti칩n de tus recolecciones">
      </app-titulo>

      <app-cards-recoleccion-ciudadano></app-cards-recoleccion-ciudadano>
    </ng-container>

    <!-- CAPACITACIONES -->
    <ng-container *ngIf="vistaActual === 'capacitaciones'">
      <app-titulo
        titulo="Capacitaciones"
        subtitulo="Consulta tus capacitaciones">
      </app-titulo>

      <app-listar-capacitaciones></app-listar-capacitaciones>
    </ng-container>

    <!-- PUNTOS DE RECICLAJE -->
    <ng-container *ngIf="vistaActual === 'puntos'">
      <div class="contenido-solicitud">
        <app-titulo
          titulo="Mis puntos"
          subtitulo=""
          [textoBoton]="mostrarPuntos ? 'Gestionar' : 'Registrar puntos'"
          iconoBoton="bi bi-plus-lg"
          colorBoton="outline-custom-success"
          hoverColorBoton="custom-success-filled"
          (clickBoton)="togglePuntos()">
        </app-titulo>

        <div class="contenedor-toggle mt-2">
          <ng-container *ngIf="mostrarPuntos">
            <div class="contenido-solicitud">
              <!-- Mostrar inline form y tarjetas al registrar puntos -->
              <app-crud-puntos [compact]="true"></app-crud-puntos>
            </div>
          </ng-container>

          <ng-container *ngIf="!mostrarPuntos">
            <div class="contenido-solicitud">
              <app-puntos-iframe></app-puntos-iframe>

              <div class="d-flex justify-content-end align-items-center mt-3">
              </div>
              <!-- Cards removed here: only the PHP iframe is displayed in the map area -->
            </div>
          </ng-container>
        </div>
      </div>
    </ng-container>

  </main>
</div>
